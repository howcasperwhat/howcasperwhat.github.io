import{d as g,r as h,o as k,e as i,c as m,C as L,j as a,u as o,q as x,x as M,D as H}from"./app-CW4kTJ_I.js";import{u as C}from"./markdown-CX-8nJNq.js";import{p as P,l as j}from"./line-CFgukNKn.js";function F(){importScripts("https://cdn.jsdelivr.net/npm/@tensorflow/tfjs");async function d(l,c,t,s){const n=Array.from({length:s},()=>0),e=tf.sequential();e.add(tf.layers.dense({units:2,inputShape:[2]})),e.add(tf.layers.dense({units:2})),e.compile({loss:"meanSquaredError",optimizer:tf.train.sgd(t)});const p=tf.tensor(l,[1,2]),_=tf.tensor(c,[1,2]),v=(r,u)=>{n[r]=u.loss};await e.fit(p,_,{epochs:s,callbacks:{onEpochEnd:v}});const f=(r,u)=>r.getWeights()[u].dataSync(),y=r=>[f(r,0),f(r,1)],T=(r,u)=>[[r[0],r[1],u[0]],[r[2],r[3],u[1]]],[b,w]=[0,1].map(r=>T(...y(e.layers[r])));return{error:n,layer1Parameter:b,layer2Parameter:w}}return d([.05,.1],[.01,.99],.01,1e3)}const B=g({__name:"LineChart",props:{data:{},xTitle:{},yTitle:{}},setup(d){const{data:l,xTitle:c="",yTitle:t=""}=d,s=h();return k(()=>{const n=P({grid:!0,nice:!0,marginTop:30,marginBottom:40,x:{label:c},y:{label:t},marks:[j(l)]});s?.value?.append(n)}),(n,e)=>(i(),m("div",{ref_key:"lineChart",ref:s},null,512))}}),$={rounded:"",b:"1 solid gray"},E={"p-4":"",flex:"~ justify-between"},S={grid:"~ flow-row gap-2 justify-center"},q=["innerHTML"],W=["innerHTML"],N=["innerHTML"],V=["innerHTML"],z={flex:"~ items-center justify-between col"},A=["disabled","op","cursor"],D={key:0,textContent:"Learn"},I={key:1,"i-svg-spinners:tadpole":"","text-4":""},R=["disabled","op","cursor"],Y=a("span",{textContent:"Terminate"},null,-1),G=[Y],J={key:0,"p-4":"","b-t":"1 solid gray",grid:"~ justify-center flow-row gap-4","children:flex":"~ justify-center","text-sm":""},K=["innerHTML"],O=["innerHTML"],Q=g({__name:"BackPropagation",setup(d){const{workerFn:l,workerTerminate:c}=L(F),t=C(),s=H(),n=h(),e=h(!1);async function p(){e.value=!0,n.value=await l(),s.success(`Learning finished. The final error is ${n.value.error.at(-1)}.`,5e3),e.value=!1}function _(){c(),s.warning("Learning terminated.",5e3),e.value=!1}return(v,f)=>(i(),m("div",$,[a("div",E,[a("div",S,[a("span",{innerHTML:o(t).renderFormula("input = [0.05, 0.10]")},null,8,q),a("span",{innerHTML:o(t).renderFormula("output = [0.01, 0.99]")},null,8,W),a("span",{innerHTML:o(t).renderFormula("step = 0.01")},null,8,N),a("span",{innerHTML:o(t).renderFormula("epoch = 1000")},null,8,V)]),a("div",z,[a("button",{btn:"","bg-green":"","h-8":"","c-black":"",disabled:e.value,op:e.value?60:100,cursor:e.value?"wait":"pointer",onClick:p},[e.value?(i(),m("div",I)):(i(),m("span",D))],8,A),a("button",{btn:"","bg-red":"","h-8":"","c-black":"",disabled:!e.value,op:e.value?100:60,cursor:e.value?"pointer":"not-allowed",onClick:_},G,8,R)])]),n.value?(i(),m("div",J,[a("span",{innerHTML:o(t).renderFormula(`
        ${o(t).matrixToLatex([["w1","w2","b1"],["w3","w4","b1"]])} = ${o(t).matrixToLatex(n.value.layer1Parameter)}`)},null,8,K),a("span",{innerHTML:o(t).renderFormula(`
        ${o(t).matrixToLatex([["w4","w5","b2"],["w6","w7","b2"]])} = ${o(t).matrixToLatex(n.value.layer2Parameter)}`)},null,8,O),(i(),x(B,{key:n.value,data:n.value.error,"x-title":"Iteration","y-title":"Error"},null,8,["data"]))])):M("",!0)]))}}),ee=g({__name:"BackPropagation",setup(d){return(l,c)=>(i(),x(Q,{"max-w-4xl":"","m-x-auto":""}))}});export{ee as default};
