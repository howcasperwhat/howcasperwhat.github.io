import{d as v,r as h,b as k,c as p,o as u,E as L,a as r,q as M,u as o,l as y,C as H}from"./app-CfJzcOGI.js";import{u as C}from"./markdown-nYJaXKht.js";import{v as P,y as F}from"./line-0n-oi2fh.js";function j(){importScripts("https://cdn.jsdelivr.net/npm/@tensorflow/tfjs");async function s(i,l,t,d){const a=Array.from({length:d},()=>0),e=tf.sequential();e.add(tf.layers.dense({units:2,inputShape:[2]})),e.add(tf.layers.dense({units:2})),e.compile({loss:"meanSquaredError",optimizer:tf.train.sgd(t)});const _=tf.tensor(i,[1,2]),f=tf.tensor(l,[1,2]),g=(n,c)=>{a[n]=c.loss};await e.fit(_,f,{epochs:d,callbacks:{onEpochEnd:g}});const m=(n,c)=>n.getWeights()[c].dataSync(),x=n=>[m(n,0),m(n,1)],b=(n,c)=>[[n[0],n[1],c[0]],[n[2],n[3],c[1]]],[T,w]=[0,1].map(n=>b(...x(e.layers[n])));return{error:a,layer1Parameter:T,layer2Parameter:w}}return s([.05,.1],[.01,.99],.01,1e3)}const B=v({__name:"LineChart",props:{data:{},xTitle:{default:""},yTitle:{default:""}},setup(s){const i=h();return k(()=>{const l=P({grid:!0,nice:!0,marginTop:30,marginBottom:40,x:{label:s.xTitle},y:{label:s.yTitle},marks:[F(s.data)]});i?.value?.append(l)}),(l,t)=>(u(),p("div",{ref_key:"lineChart",ref:i},null,512))}}),$={rounded:"",b:"1 solid gray"},E={"p-4":"",flex:"~ justify-between"},S={grid:"~ flow-row gap-2 justify-center"},q=["innerHTML"],W=["innerHTML"],N=["innerHTML"],V=["innerHTML"],z={flex:"~ items-center justify-between col"},A=["disabled","op","cursor"],I={key:0,textContent:"Learn"},R={key:1,"i-svg-spinners:tadpole":"","text-4":""},Y=["disabled","op","cursor"],D={key:0,"p-4":"","b-t":"1 solid gray",grid:"~ justify-center flow-row gap-4","children:flex":"~ justify-center","text-sm":""},G=["innerHTML"],J=["innerHTML"],K=v({__name:"BackPropagation",setup(s){const{workerFn:i,workerTerminate:l}=L(j),t=C(),d=H(),a=h(),e=h(!1);async function _(){e.value=!0,a.value=await i(),d.success(`Learning finished. The final error is ${a.value.error.at(-1)}.`,5e3),e.value=!1}function f(){l(),d.warning("Learning terminated.",5e3),e.value=!1}return(g,m)=>(u(),p("div",$,[r("div",E,[r("div",S,[r("span",{innerHTML:o(t).renderFormula("input = [0.05, 0.10]")},null,8,q),r("span",{innerHTML:o(t).renderFormula("output = [0.01, 0.99]")},null,8,W),r("span",{innerHTML:o(t).renderFormula("step = 0.01")},null,8,N),r("span",{innerHTML:o(t).renderFormula("epoch = 1000")},null,8,V)]),r("div",z,[r("button",{"h-8":"",btn:"","bg-green":"","c-black":"",disabled:e.value,op:e.value?60:100,cursor:e.value?"wait":"pointer",onClick:_},[e.value?(u(),p("div",R)):(u(),p("span",I))],8,A),r("button",{"h-8":"",btn:"","bg-red":"","c-black":"",disabled:!e.value,op:e.value?100:60,cursor:e.value?"pointer":"not-allowed",onClick:f},m[0]||(m[0]=[r("span",{textContent:"Terminate"},null,-1)]),8,Y)])]),a.value?(u(),p("div",D,[r("span",{innerHTML:o(t).renderFormula(`
        ${o(t).matrixToLatex([["w1","w2","b1"],["w3","w4","b1"]])} = ${o(t).matrixToLatex(a.value.layer1Parameter)}`)},null,8,G),r("span",{innerHTML:o(t).renderFormula(`
        ${o(t).matrixToLatex([["w4","w5","b2"],["w6","w7","b2"]])} = ${o(t).matrixToLatex(a.value.layer2Parameter)}`)},null,8,J),(u(),y(B,{key:a.value,data:a.value.error,"x-title":"Iteration","y-title":"Error"},null,8,["data"]))])):M("",!0)]))}}),X=v({__name:"BackPropagation",setup(s){return(i,l)=>(u(),y(K,{"m-x-auto":"","max-w-4xl":""}))}});export{X as default};
